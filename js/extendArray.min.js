(function(k){function l(){function k(b,a){var e=this.dimensions(b),d=this.dimensions(a),c;if(e.length!==d.length)return!1;for(c=0;c<e.length;c++)if(e[c]!==d[c])return!1;return!0}function n(b){var a=[],e=b.length,d;a[0]=[];for(d=0;d<e;d++)a[0][d]=b[d];return a}function p(b,a){var e=b.length,d=[],c;a&&1===e&&e.unshift(e[0]);if(3>e)for(e=0;e<b[0];e++)for(d[e]=[],c=0;c<b[1];c++)d[e][c]=e===c?1:0;else for(c=b[0],e=0;e<c;e++)d[e]=p(b.slice(1),!1);return d}function l(b,a){var e=[],d=a[0],c,f;for(c=0;c<d;c++)for(e[c]=
[],f=0;f<d;f++)e[c][f]=Math.pow(-1,c+f)*this.determinant(this.subset(b,[this.serialIndex(0,a[0]-1,1,[c]),this.serialIndex(0,a[0]-1,1,[f])]),!1);return e}var m={checkArray:function(b){return void 0===b?!1:-1<b.constructor.toString().indexOf("Array")?!0:!1},dimensions:function(b){if(void 0===b)return[];if(0===b.length)return 0;if(!this.checkArray(b))return!1;var a=[];return void 0===b[0].length?[b.length]:a=a.concat(b.length,this.dimensions(b[0]))},initialize:function(b,a,e){void 0===e&&(e=!0);if(e){if(void 0===
b||0===b.length)return[];if(!this.checkArray(b)||2<arguments.length||"ones"!==a&&"zeros"!==a&&"rands"!==a&&"empty"!==a&&"eye"!==a)return!1;if("eye"===a)return p.bind(this,b,e)()}var d=[],c;if(1===b.length){d=b[0];c=[];var f;for(f=0;f<d;f++)c[f]="ones"===a?1:"rands"===a?Math.random():"empty"===a?void 0:0;return c}c=b[0];for(f=0;f<c;f++)d[f]=this.initialize(b.slice(1),a,!1);return d},transpose:function(b,a){if(void 0===b||0===b.length)return[];if(!this.checkArray(b))return!1;void 0===a&&(a=[]);var e=
this.dimensions(b),d;if(1===e.length)if(0===a.length)for(d=0;d<e[0];d++)a[d]=[b[d]];else{var c=this.dimensions(a);for(d=0;d<e[0];d++)a[d][c[1]]=b[d]}else for(e=e.shift(),d=0;d<e;d++)a=this.transpose(b[d],a);return a},crossProduct:function(b,a,e){void 0===e&&(e=!0);if(e){if(void 0===b||void 0===a)return[];if(!this.checkArray(b)||!this.checkArray(a))return!1}var d=this.dimensions(b),c=this.dimensions(a),f=[];if(e){1===d.length&&(d.unshift(1),b=n(b));1===c.length&&(c.unshift(1),a=n(a));if(2<d.length)return console.error("Matrix multipication higher than 2D not supported"),
!1;if(d[1]!=c[0])return console.error("Columns of first array do not match rows of second"),!1;a=this.transpose(a)}if(1===d.length)return this.stat(this.dotOperation(b,a,"multiply"),"add")[0];e=d[0];c=c[1];for(d=0;d<e;d++){f[d]=[];for(var g=0;g<c;g++)f[d][g]=this.crossProduct(b[d],a[g],!1)}return f},dotOperation:function(b,a,e){if(void 0===b||void 0===a||void 0===e)return[];if(!this.checkArray(b)||!this.checkArray(a))return!1;if(!k.bind(this,b,a)())return console.error("Arrays must be of same dimensions"),
!1;if("add"!==e&&"subtract"!==e&&"multiply"!==e&&"divide"!==e)return!1;var d=this.dimensions(b),c=[];if(1===d.length)if("add"===e)for(var f=0;f<d[0];f++)c[f]=b[f]+a[f];else if("subtract"===e)for(f=0;f<d[0];f++)c[f]=b[f]-a[f];else if("multiply"===e)for(f=0;f<d[0];f++)c[f]=b[f]*a[f];else{if("divide"===e)for(f=0;f<d[0];f++)c[f]=b[f]/a[f]}else for(d=d.shift(),f=0;f<d;f++)c[f]=this.dotOperation(b[f],a[f],e);return c},scalarOperation:function(b,a,e,d){if(void 0===b||void 0===a)return[];void 0===d&&(d=!0);
if(d){if("add"!==a&&"subtract"!==a&&"multiply"!==a&&"divide"!==a&&"abs"!==a&&"power"!==a&&"sqrt"!==a&&"log"!==a&&"log10"!==a&&"copy"!==a)return!1;if("abs"===a||"sqrt"===a||"log"===a||"log10"===a||"copy"===a)e=0;if(void 0===e||"number"!==typeof e)return b;if(!this.checkArray(b))return!1}var c=this.dimensions(b),f;d=[];if(1===c.length)if(f=c[0],"add"===a)for(c=0;c<f;c++)d[c]=b[c]+e;else if("subtract"===a)for(c=0;c<f;c++)d[c]=b[c]-e;else if("multiply"===a)for(c=0;c<f;c++)d[c]=b[c]*e;else if("divide"===
a)for(c=0;c<f;c++)d[c]=b[c]/e;else if("abs"===a)for(c=0;c<f;c++)d[c]=Math.abs(b[c]);else if("power"===a)for(c=0;c<f;c++)d[c]=Math.pow(b[c],e);else if("sqrt"===a)for(c=0;c<f;c++)d[c]=Math.sqrt(b[c]);else if("log"===a)for(c=0;c<f;c++)d[c]=Math.log(b[c]);else if("log10"===a)for(c=0;c<f;c++)d[c]=Math.log10(b[c]);else{if("copy"===a)for(c=0;c<f;c++)d[c]=b[c]}else for(f=c.shift(),c=0;c<f;c++)d[c]=this.scalarOperation(b[c],a,e,!1);return d},stat:function(b,a,e){if(void 0===b)return[];if(!this.checkArray(b)||
"mean"!==a&&"max"!==a&&"min"!==a&&"popstd"!==a&&"samstd"!==a&&"absmax"!==a&&"absmin"!==a&&"add"!==a)return!1;void 0===e&&(e="horizontal");if("vertical"===e)return b=m.transpose(b),m.stat(b,a);var d=this.dimensions(b),c;e=[];if(1===d.length)if(c=d[0],"mean"===a){for(d=a=0;d<c;d++)a+=b[d];e[0]=a/c}else if("max"===a)e[0]=Math.max.apply(null,b);else if("absmax"===a)e[0]=Math.max.apply(null,this.scalarOperation(b,"abs"));else if("absmin"===a)e[0]=Math.min.apply(null,this.scalarOperation(b,"abs"));else if("min"===
a)e[0]=Math.min.apply(null,b);else if("add"===a){for(d=a=0;d<c;d++)a+=b[d];e[0]=a}else"popstd"===a?(this.stat(b,"mean"),e[0]=Math.sqrt(this.stat(this.power(this.scalarOperation(b,"subtract",this.stat(b,"mean")[0]),2),"add")[0]/c)):"samstd"===a&&(this.stat(b,"mean"),e[0]=Math.sqrt(this.stat(this.power(this.scalarOperation(b,"subtract",this.stat(b,"mean")[0]),2),"add")[0]/(c-1)));else for(c=d.shift(),d=0;d<c;d++)e[d]=this.stat(b[d],a);return e},subset:function(b,a){if(void 0===b)return[];if(!this.checkArray(b)&&
!this.checkArray(a))return!1;var e=this.dimensions(b),d=[],c,f;if(a.length>e.length)return!1;if(a.length<e.length)for(f=0;f<e.length-a.length;f++)a[a.length]=":";for(f=0;f<a.length;f++)if("number"===typeof a[f])a[f]=[a[f]];else if(":"===a[f])for(a[f]=[],c=0;c<e[f];c++)a[f][c]=c;c=":"===a[0]?b[0].length:a[0].length;if(1===e.length)for(f=0;f<c;f++)d[f]=b[a[0][f]];else for(f=0;f<c;f++)d[f]=this.subset(b[a[0][f]],a.slice(1));return d},determinant:function(b,a,e){void 0===a&&(a=!0);var d=this.dimensions(b);
if(a){if(void 0===b)return[];if(!this.checkArray(b))return!1;if(2!==d.length)return console.error("Supports 2D matrices only"),!1;if(d[0]!==d[1])return console.error("Supports square matrices only"),!1;b=this.scalarOperation(b,"copy");void 0===e&&(e=0)}if(1===d[0])return b[0][0];if(2===d[0])return b[0][0]*b[1][1]-b[0][1]*b[1][0];var c=this.serialIndex(1,d[0]-1);a=d[0];var f=d[1],g,h;for(g=d=1;g<a;g++)for(h=1;h<f;h++)b[g][h]=b[g][h]*b[0][0]-b[g][0]*b[0][h];Math.abs(b[1][1])>Math.pow(10,5)?(d=Math.pow(10,
-5),b=this.scalarOperation(b,"multiply",d)):Math.abs(b[1][1])<Math.pow(10,-5)&&(d=Math.pow(10,5),b=this.scalarOperation(b,"multiply",d));c=this.subset(b,[c,c]);e=this.determinant(c,!1,e);e/=d;for(g=1;g<a-1;g++)e/=b[0][0];return e},serialIndex:function(b,a,e,d){void 0===e&&(e=1);void 0===d&&(d=[]);if(!this.checkArray(d))return console.error("exclude argument is an array"),!1;var c=[],f=-1,g=!1;for(0!==d.length&&(g=!0);b<=a;b+=e)g&&(f=d.indexOf(b)),-1===f&&(c[c.length]=b);return c},inverse:function(b,
a){void 0===a&&(a=!0);var e=this.dimensions(b);if(a){if(void 0===b)return[];if(!this.checkArray(b))return!1}if(2!==e.length)return console.error("Supports 2D matrices only"),!1;if(e[0]!==e[1])return console.error("Supports square matrices only"),!1;e=this.determinant(b);return 0===e?(console.error("Inverse of singular matrix cannot be determined"),!1):this.scalarOperation(this.adjoint(b,!1),"divide",e)},pseudoinverse:function(b){if(void 0===b)return[];if(!this.checkArray(b))return!1;var a=this.dimensions(b);
if(2<a.length)return console.error("Supports only upto 2D"),!1;var e=this.transpose(b);return a[0]>a[1]?this.crossProduct(this.inverse(this.crossProduct(e,b),!1),e):this.crossProduct(e,this.inverse(this.crossProduct(b,e),!1))},adjoint:function(b,a){void 0===a&&(a=!0);if(a){if(void 0===b)return[];if(!this.checkArray(b))return!1}var e=this.dimensions(b);if(a){if(2!==e.length)return console.error("Supports 2D matrices only"),!1;if(e[0]!==e[1])return console.error("Supports square matrices only"),!1}return this.transpose(l.bind(this,
b,e)())},print:function(b){if(void 0===b)return[];if(!this.checkArray(b))return!1;var a=this.dimensions(b),e,d="";if(2<a.length)return console.error("Supports upto 2D matrices only"),!1;if(2===a.length){e=a[0];for(var a=a[1],d=d+"[",c=0;c<e;c++){for(var d=d+"[",f=0;f<a;f++)d=f===a-1?d+b[c][f]:d+(b[c][f]+", ");d=c!==e-1?d+"],":d+"]"}}else for(e=a[0],d+="[",c=0;c<e;c++)d=c===e-1?d+b[c]:d+(b[c]+", ");return d+"]"}};return m}"undefined"===typeof Library&&(k.ExtendArray=l())})(window);