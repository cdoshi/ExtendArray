(function(k){function l(){function k(b,a){var d=this.dimensions(b),e=this.dimensions(a),c;if(d.length!==e.length)return!1;for(c=0;c<d.length;c++)if(d[c]!==e[c])return!1;return!0}function n(b){var a=[],d=b.length,e;a[0]=[];for(e=0;e<d;e++)a[0][e]=b[e];return a}function p(b,a){var d=b.length,e=[],c;a&&1===d&&d.unshift(d[0]);if(3>d)for(d=0;d<b[0];d++)for(e[d]=[],c=0;c<b[1];c++)e[d][c]=d===c?1:0;else for(c=b[0],d=0;d<c;d++)e[d]=p(b.slice(1),!1);return e}function l(b,a){var d=[],e=a[0],c,f;for(c=0;c<e;c++)for(d[c]=
[],f=0;f<e;f++)d[c][f]=Math.pow(-1,c+f)*this.determinant(this.subset(b,[this.serialIndex(0,a[0]-1,1,[c]),this.serialIndex(0,a[0]-1,1,[f])]),!1);return d}var m={checkArray:function(b){return void 0===b?!1:-1<b.constructor.toString().indexOf("Array")?!0:!1},dimensions:function(b,a){if(void 0===a){if(void 0===b)return[];if(0===b.length)return 0;if(!this.checkArray(b))return!1}var d=[];return void 0===b[0].length?[b.length]:d=d.concat(b.length,this.dimensions(b[0],!1))},initialize:function(b,a,d){void 0===
d&&(d=!0);if(d){if(void 0===b||0===b.length)return[];if(!this.checkArray(b)||2<arguments.length||"ones"!==a&&"zeros"!==a&&"rands"!==a&&"empty"!==a&&"eye"!==a)return!1;if("eye"===a)return p.bind(this,b,d)()}var e=[],c;if(1===b.length){e=b[0];c=[];var f;for(f=0;f<e;f++)c[f]="ones"===a?1:"rands"===a?Math.random():"empty"===a?void 0:0;return c}c=b[0];for(f=0;f<c;f++)e[f]=this.initialize(b.slice(1),a,!1);return e},transpose:function(b,a,d){if(void 0===d){if(void 0===b||0===b.length)return[];if(!this.checkArray(b))return!1;
void 0===a&&(a=[])}var e=this.dimensions(b);if(1===e.length)if(0===a.length)for(d=0;d<e[0];d++)a[d]=[b[d]];else{var c=this.dimensions(a);for(d=0;d<e[0];d++)a[d][c[1]]=b[d]}else for(e=e.shift(),d=0;d<e;d++)a=this.transpose(b[d],a,!1);return a},crossProduct:function(b,a,d){if(void 0===d){if(void 0===b||void 0===a)return[];if(!this.checkArray(b)||!this.checkArray(a))return!1}var e=this.dimensions(b),c=this.dimensions(a),f=[];if(d){1===e.length&&(e.unshift(1),b=n(b));1===c.length&&(c.unshift(1),a=n(a));
if(2<e.length)return console.error("Matrix multipication higher than 2D not supported"),!1;if(e[1]!=c[0])return console.error("Columns of first array do not match rows of second"),!1;a=this.transpose(a)}if(1===e.length)return this.stat(this.dotOperation(b,a,"multiply"),"add")[0];d=e[0];c=c[1];for(e=0;e<d;e++){f[e]=[];for(var g=0;g<c;g++)f[e][g]=this.crossProduct(b[e],a[g],!1)}return f},dotOperation:function(b,a,d,e){if(void 0===e){if(void 0===b||void 0===a||void 0===d)return[];if(!this.checkArray(b)||
!this.checkArray(a))return!1;if(!k.bind(this,b,a)())return console.error("Arrays must be of same dimensions"),!1}if("add"!==d&&"subtract"!==d&&"multiply"!==d&&"divide"!==d)return!1;var c=this.dimensions(b);e=[];if(1===c.length)if("add"===d)for(var f=0;f<c[0];f++)e[f]=b[f]+a[f];else if("subtract"===d)for(f=0;f<c[0];f++)e[f]=b[f]-a[f];else if("multiply"===d)for(f=0;f<c[0];f++)e[f]=b[f]*a[f];else{if("divide"===d)for(f=0;f<c[0];f++)e[f]=b[f]/a[f]}else for(c=c.shift(),f=0;f<c;f++)e[f]=this.dotOperation(b[f],
a[f],d,!1);return e},scalarOperation:function(b,a,d,e){if(void 0===b||void 0===a)return[];if(void 0===e){if("add"!==a&&"subtract"!==a&&"multiply"!==a&&"divide"!==a&&"abs"!==a&&"power"!==a&&"sqrt"!==a&&"log"!==a&&"log10"!==a&&"copy"!==a)return!1;if("abs"===a||"sqrt"===a||"log"===a||"log10"===a||"copy"===a)d=0;if(void 0===d||"number"!==typeof d)return b;if(!this.checkArray(b))return!1}var c=this.dimensions(b),f;e=[];if(1===c.length)if(f=c[0],"add"===a)for(c=0;c<f;c++)e[c]=b[c]+d;else if("subtract"===
a)for(c=0;c<f;c++)e[c]=b[c]-d;else if("multiply"===a)for(c=0;c<f;c++)e[c]=b[c]*d;else if("divide"===a)for(c=0;c<f;c++)e[c]=b[c]/d;else if("abs"===a)for(c=0;c<f;c++)e[c]=Math.abs(b[c]);else if("power"===a)for(c=0;c<f;c++)e[c]=Math.pow(b[c],d);else if("sqrt"===a)for(c=0;c<f;c++)e[c]=Math.sqrt(b[c]);else if("log"===a)for(c=0;c<f;c++)e[c]=Math.log(b[c]);else if("log10"===a)for(c=0;c<f;c++)e[c]=Math.log10(b[c]);else{if("copy"===a)for(c=0;c<f;c++)e[c]=b[c]}else for(f=c.shift(),c=0;c<f;c++)e[c]=this.scalarOperation(b[c],
a,d,!1);return e},stat:function(b,a,d,e){if(void 0===e){if(void 0===b)return[];if(!this.checkArray(b)||"mean"!==a&&"max"!==a&&"min"!==a&&"popstd"!==a&&"samstd"!==a&&"absmax"!==a&&"absmin"!==a&&"add"!==a&&"multiply"!==a)return!1;void 0===d&&(d="horizontal")}if("vertical"===d)return b=m.transpose(b),m.stat(b,a);e=this.dimensions(b);var c;d=[];if(1===e.length)if(c=e[0],"mean"===a){for(e=a=0;e<c;e++)a+=b[e];d[0]=a/c}else if("max"===a)d[0]=Math.max.apply(null,b);else if("absmax"===a)d[0]=Math.max.apply(null,
this.scalarOperation(b,"abs"));else if("absmin"===a)d[0]=Math.min.apply(null,this.scalarOperation(b,"abs"));else if("min"===a)d[0]=Math.min.apply(null,b);else if("add"===a){for(e=a=0;e<c;e++)a+=b[e];d[0]=a}else if("multiply"===a){a=1;for(e=0;e<c;e++)a*=b[e];d[0]=a}else"popstd"===a?(this.stat(b,"mean"),d[0]=Math.sqrt(this.stat(this.power(this.scalarOperation(b,"subtract",this.stat(b,"mean")[0]),2),"add")[0]/c)):"samstd"===a&&(this.stat(b,"mean"),d[0]=Math.sqrt(this.stat(this.power(this.scalarOperation(b,
"subtract",this.stat(b,"mean")[0]),2),"add")[0]/(c-1)));else for(c=e.shift(),e=0;e<c;e++)d[e]=this.stat(b[e],a,!1);return d},subset:function(b,a,d){if(void 0===d){if(void 0===b)return[];if(!this.checkArray(b)&&!this.checkArray(a))return!1}d=this.dimensions(b);var e=[],c,f;if(a.length>d.length)return!1;if(a.length<d.length)for(f=0;f<d.length-a.length;f++)a[a.length]=":";for(f=0;f<a.length;f++)if("number"===typeof a[f])a[f]=[a[f]];else if(":"===a[f])for(a[f]=[],c=0;c<d[f];c++)a[f][c]=c;c=":"===a[0]?
b[0].length:a[0].length;if(1===d.length)for(f=0;f<c;f++)e[f]=b[a[0][f]];else for(f=0;f<c;f++)e[f]=this.subset(b[a[0][f]],a.slice(1),!1);return e},determinant:function(b,a,d){void 0===a&&(a=!0);var e=this.dimensions(b);if(a){if(void 0===b)return[];if(!this.checkArray(b))return!1;if(2!==e.length)return console.error("Supports 2D matrices only"),!1;if(e[0]!==e[1])return console.error("Supports square matrices only"),!1;b=this.scalarOperation(b,"copy");void 0===d&&(d=0)}if(1===e[0])return b[0][0];if(2===
e[0])return b[0][0]*b[1][1]-b[0][1]*b[1][0];var c=this.serialIndex(1,e[0]-1);a=e[0];var f=e[1],g,h;for(g=e=1;g<a;g++)for(h=1;h<f;h++)b[g][h]=b[g][h]*b[0][0]-b[g][0]*b[0][h];Math.abs(b[1][1])>Math.pow(10,5)?(e=Math.pow(10,-5),b=this.scalarOperation(b,"multiply",e)):Math.abs(b[1][1])<Math.pow(10,-5)&&(e=Math.pow(10,5),b=this.scalarOperation(b,"multiply",e));c=this.subset(b,[c,c]);d=this.determinant(c,!1,d);d/=e;for(g=1;g<a-1;g++)d/=b[0][0];return d},serialIndex:function(b,a,d,e,c){void 0===d&&(d=1);
void 0===e&&(e=[]);if(!this.checkArray(e))return console.error("exclude argument is an array"),!1;void 0===c&&(c=0);var f=[],g=-1,h=!1;for(0!==e.length&&(h=!0);b<=a||f.length<c;)h&&(g=e.indexOf(b)),-1===g&&(f[f.length]=b),b+=d;return f},inverse:function(b,a){void 0===a&&(a=!0);var d=this.dimensions(b);if(a){if(void 0===b)return[];if(!this.checkArray(b))return!1}if(2!==d.length)return console.error("Supports 2D matrices only"),!1;if(d[0]!==d[1])return console.error("Supports square matrices only"),
!1;d=this.determinant(b);return 0===d?(console.error("Inverse of singular matrix cannot be determined"),!1):this.scalarOperation(this.adjoint(b,!1),"divide",d)},pseudoinverse:function(b){if(void 0===b)return[];if(!this.checkArray(b))return!1;var a=this.dimensions(b);if(2<a.length)return console.error("Supports only upto 2D"),!1;var d=this.transpose(b);return a[0]>a[1]?this.crossProduct(this.inverse(this.crossProduct(d,b),!1),d):this.crossProduct(d,this.inverse(this.crossProduct(b,d),!1))},adjoint:function(b,
a){void 0===a&&(a=!0);if(a){if(void 0===b)return[];if(!this.checkArray(b))return!1}var d=this.dimensions(b);if(a){if(2!==d.length)return console.error("Supports 2D matrices only"),!1;if(d[0]!==d[1])return console.error("Supports square matrices only"),!1}return this.transpose(l.bind(this,b,d)())},serialize:function(b,a){void 0===a&&(a=!0);if(a){if(void 0===b)return[];if(!this.checkArray(b))return!1}var d=[],e=this.dimensions(b);if(1===e.length)for(var c=0;c<e;c++)d[c]=b[c];else for(e=e[0],c=0;c<e;c++)d=
d.concat(this.serialize(b[c],!1));return d},reshape:function(b,a,d,e){void 0===e&&(e=!0);if(e){if(void 0===b)return[];if(!this.checkArray(b)||!this.checkArray(a))return!1;e=this.dimensions(b);var c=this.stat(e,"multiply")[0];if(c!==this.stat(a,"multiply")[0])return console.error("Can't reshape "+this.print(e)+" array to "+this.print(a)+" array"),!1;1<e.length&&(b=this.serialize(b));if(void 0===d)d=1;else if(c%d)return console.error("Cannot reshape with this jump value"),!1}e=[];if(1===a.length)for(c=
0;c<b.length;c++)e[c]=b[c];else{var f=a[0],g=this.stat(a,"multiply")[0]/f;a=this.subset(a,[this.serialIndex(1,a.length-1)]);for(c=0;c<f;c++)1===d?e.push(this.reshape(this.subset(b,[this.serialIndex(c*g,0,d,[],g)]),a,d,!1)):e.push(this.reshape(this.subset(b,[this.serialIndex(c,0,f,[],g)]),a,d,!1))}return e},print:function(b){if(void 0===b)return[];if(!this.checkArray(b))return!1;var a=this.dimensions(b),d,e="";if(2<a.length)return console.error("Supports upto 2D matrices only"),!1;if(2===a.length){d=
a[0];for(var a=a[1],e=e+"[",c=0;c<d;c++){for(var e=e+"[",f=0;f<a;f++)e=f===a-1?e+b[c][f]:e+(b[c][f]+", ");e=c!==d-1?e+"],":e+"]"}}else for(d=a[0],e+="[",c=0;c<d;c++)e=c===d-1?e+b[c]:e+(b[c]+", ");return e+"]"}};return m}"undefined"===typeof Library&&(k.ExtendArray=l())})(window);